# 角色扮演生存小游戏

## 游戏概述
基于网页运行的角色扮演游戏。玩家通过虚拟摇杆操控扮演一名冒险家。游戏世界中探索，收集，战斗，成长

## 核心玩法

### 角色系统
- 角色移动：角色移动具有速度和惯性，外部对角色的操作只能给角色施加加速度，而不能直接改变速度
- 角色移动：角色死亡时有一个过程，会闪烁1.5秒，并被击飞
- 角色渲染：角色由两个几何形状分别绘制身体和头部，结合角色状态要能表现出向左待机，向右待机，向左移动，向右移动四种状态，运动表现风格类似忍者奔跑

### 玩家控制
- 摇杆：玩家通过虚拟摇杆控制角色移动，虚拟摇杆在点击时出现在点击位置，角色靠近敌人时自动攻击。摇杆不直接控制角色速度，而是给与加速度
- 键盘：也可以通过键盘awsd控制角色移动

### 武器系统
- 渲染：角色携带武器，武器渲染的深度应在角色之上，注意res中的武器图片均为武器正面斜45度向右上
- 剑：剑的攻击呈现挥舞的感觉，要夸张，旋转伴随缩放，并且在攻击方向上有位移，攻击频率2秒一次，举起剑0.2s，加速劈下0.1s，攻击后摇0.2s，剩下的事件剑恢复到正常持剑状态等待冷却。使用拖尾表示剑的攻击特效。
- 弓：弓始终指向瞄准的目标，切换目标时快速旋转避免跳变，弓箭会发射箭矢攻击敌人
- 骑枪：骑乘时可用，平时竖直立起，当角色速度达到最大时放平进入冲刺状态。冲刺状态在冲到人后结束进入1s冷却。或者角色速度低于70%后结束。冲刺造成巨量伤害

### 骑乘系统
- 渲染：马头的图片渲染在角色前方偏下，于角色的动画配合，营造骑马的感觉
- 移动：骑马会赋予玩家新的移动参数，更快的速度和较差的灵活度
- 马匹：不同的马具有不同的速度和灵活度参数


### 攻击判定系统
- **概述**：围绕攻击框和受击框在攻击框生命周期内的碰撞检测构建攻击判定系统，武器的攻击行为触发攻击框。攻击框携带攻击效果，攻击效果包含伤害，击退，攻击敌人个数

### 角色定义
- 玩家：尺寸2.0，初始持剑骑马，速度较快，灵活度一般
- 步兵：尺寸1.5，持剑，速度较慢，灵活度高
- 骑兵：尺寸1.5，持骑枪骑马，速度较快，灵活度较低，具备来回冲锋的行为逻辑
- 弓兵：尺寸1.5，持弓，速度慢，灵活度高，攻击频率为2s一次
- **npc生成**：左侧持续刷新友军，右侧持续刷新敌军。步兵，弓箭，骑兵的比例应为4：2：1

### 战斗地图
- 可移动区域：狭长形地图，高度为20，宽度为150
- 建筑：左侧有玩家出兵建筑，右侧有敌人出兵建筑，每10s出一波兵，步兵4，弓箭2，骑兵1

### npcAI
- 步兵：靠近并攻击最近的敌人，每3s刷新目标
- 弓兵：于目标保持80%最大射程的距离，每8s刷新目标
- 骑兵：来回用骑枪冲锋最近的敌人，每15s刷新目标

### 碰撞系统
- **概述**：角色具备圆形碰撞和质量，允许角色重叠，当角色之间碰撞重叠时，依据重叠的深度，产生反向的推挤位移

### 掉落系统
- **金币**：敌人死亡掉落金币，金币需要有一个跳出来的动画。 玩家可以拾取金币，拾取后金币飞向右上角金币计数条。

### 升级系统
- **升级**：角色初始仅拥有剑，可以通过角色升级弹窗选择增加弓箭武器还是长枪武器，两个选项均为一次性
- **升级**：金币计数条满10个和50个时触发升级。暂停游戏并触发角色升级弹窗

### 美术资源描述
- **概述**：美术资源在.res文件夹里
- **武器**：武器和箭矢的图片都是斜45度向右上的。剑的剑柄即旋转锚点在图片左下30%处。
- **角色**：马的图片仅仅是马的头部

### 分辨率
- **概述**：按照手机竖屏安排布局




## 技术栈
- HTML5 Canvas 渲染
- JavaScript 游戏逻辑
- CSS3 界面样式
- 纯前端实现，不需要服务端，打开index.html 即可运行，避免使用 ES6 模块

## 目标平台
现代浏览器（Chrome、Firefox、Edge、Safari）

请根据本文档生成AI2AI.md  描述项目架构


## 开发顺序
- 迭代1，正确的地图尺寸，可操控的主角，骑马，
- 迭代2，主角装备三种武器，随机生成敌对士兵用以测试武器效果
- 迭代3，完善士兵ai，按照战斗地图逻辑出兵
- 迭代4，主角初始持剑，敌兵掉落金币，实装主角成长